# GeoAuth Device API Specification

## Overview
The GeoAuth Device API provides the interface for user devices to send data to GeoAuth's servers. It allows for device registration, location updates, and location region creations.

## API Specification
### Format
Each endpoint is specified as a ``<URI> : <METHOD>`` pair. Parameters are listed below the HTTP specification (if there are any). The return value is listed below parameters, and a description then follows the return value description.

### ``/api/device/register`` : ``POST``
**Parameters:**

* ``device_key``: a 32-character device registration key generated by ``/api/service/request-device-key``
* ``device_name``: the plain-English name of the device
* ``username``: the device owner's account username
* ``password``: the device owner's account password

**Return:**

* ``200``:``string(32)``: a 32-character device ID string


This endpoint service device registrations. Devices must be registered with a device key generated by an API account (this is to prevent spurious registrations through sites not using the service). The registered device is associated with its owner's GeoAuth identity to track their location. This returns an HTTP 200 response with a 32-character ID string for the device (used as the ``device_id`` parameter for the other endpoints in this API).

### ``/api/device/check-in`` : ``POST``
**Parameters:**

* ``device_id``: a 32-character device API key assigned to the device when it was registered
* ``latitude``: the latitude of the location update
* ``longitude``: the longitude of the location update
* ``time``: the time that the update took place

**Return:**

* ``200``:``OK``: acknowledges successful addition

This endpoint services device location updates. It will verify that a device is registered with the given ``device_id``, and will not store updates sent from unregistered devices. Time is given as UTC. It returns an HTTP 200 if the check-in was successful, HTTP 403 if the device ID was incorrect, and 500 if there was a processing error.


### ``/api/device/add-region`` : ``POST``
**Parameters:**

* ``device_id``: a 32-character device API key assigned to the device when it was registered
* ``latitude``: the latitude of the location region
* ``longitude``: the longitude of the location region
* ``name``: the plain-English name of the region
* ``time`` (OPTIONAL): the time that the update took place
* ``radius`` (OPTIONAL): the radius of the circular area which should be considered part of this region

**Return:**

* ``200``:``OK``: acknowledges successful addition

This endpoint services device location region creation. Regions are used to generate queries (i.e., "where were you yesterday at 6pm" can have a response like "home", which would be a region around the user's house). Variable radius allows for flexibility in spatial specificity. It returns an HTTP 200 if the region add was successful, HTTP 403 if the device ID was incorrect, and 500 if there was a processing error.

